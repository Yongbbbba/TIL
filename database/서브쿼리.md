```mssql
-- subquery (서브쿼리/하위쿼리)
-- SQL 명령문 안에 지정하는 하부 SELECT

-- 연봉이 역대급으로 높은 선수의 정보를 추출
select top 1 *
from salaries
order by salary desc;

-- rodrial01
select *
from players
where playerID = 'rodrial01'

-- 이것을 한 번에 하려면?
-- 단일행 서브쿼리
select nameFirst + ' ' + nameLast as fullname
from players
where playerID = (select top 1 playerID from salaries order by salary desc);

-- 다중행
select nameFirst + ' ' + nameLast as fullname
from players
where playerID in (select top 20 playerID from salaries order by salary desc);

-- 서브쿼리는 WHERE에서 가장 많이 사용되지만, 나머지 구문에서도 사용 가능
select (select count(*) from players) as playerCount, (select count(*) from batting) as battingCount;

-- INSERT에서도 사용 가능
select *
from salaries
order by yearID desc

-- insert into
insert into salaries
values (2020, 'KOR', 'NL', 'rookiss', (select max(salary) from salaries))

-- insert select
insert into salaries_temp
select yearID, playerID, salary from salaries;

-- 상관 관계 서브쿼리
-- EXISTS, NOT EXISTS
-- 당장 자유자재로 사용은 못해도 되니까 -> 기억만 하시면 됩니다. 읽을 줄만 알면 됨

-- 포스트 시즌 타격에 참여한 선수들 목록
select *
from players
where playerID in (select playerID from battingpost);

select *
from players
where exists (select playerID from battingpost where players.playerID = battingPost.playerID )

-- 실행계획
-- ctrl + L
```

